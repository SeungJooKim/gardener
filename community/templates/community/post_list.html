{% extends "base.html" %}
{% load static %}

{% block content %}
    <form action = '' method="GET">
        <select name="type" id="search-type">
                <option value="tag">태그</option>
                <option value="title">제목</option>
                  <option value="content">내용</option>
        </select>
        <div>
            <input type="text" name ='q' value="{{q}}" placeholder="검색어를 입력하세요" />
            <button type="submit">검색</button>
        </div>
    </form>
    {% if q %}
            <h5>'{{ q }}' 검색 결과입니다.</h5>
    {% endif %}
    <p><a href="{% url 'community:post_create' %}">포스트 생성</a></p>
    <table>
        <tbody>
            {% if post_list %}
                {% for post in post_list %}
                    <p><a href="{% url 'community:post_detail' pk=post.pk %}">제목: {{ post.title }}</a></p>
                    <p>{{ post.user_id }}</p>
                    
                    <p>{{ post.content|safe }}</p>
                    {% for tag in post.tags.all %}
                        <span>#{{tag.name}}</span>
                    {% endfor %}
                {% endfor %}
            {% else %}
            {% if q %}
                <tr>
                    <td>
                        일치하는 검색 결과가 없습니다.
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td>
                        작성된 게시글이 없습니다.
                    </td>
                </tr>
            {% endif %}

            {% endif %}
        </tbody>
    </table>
    {% if is_paginated %}
        <ul class="pagination">
        {% if page_obj.has_previous %}
        <li class="page-item">
            <a class="page-link" href="?type={{type}}&q={{q}}&page={{ page_obj.previous_page_number }}"
            tabindex="-1">이전</a>
         </li>
        {% else %}
        <li class="page-item disabled">
            <a class="page-link" href="#" tabindex="-1">이전</a>
         </li>
        {% endif %}

        {% for page in page_range %}
        <li class="page-item {% if page == page_obj.number %} activate {% endif %}">
            <a class="page-link" href="?type={{type}}&q={{q}}&page={{ page }}">{{ page }}</a>
        </li>
        {% endfor %}

        {% if page_obj.has_next %}
        <li class="page-item">
        <a class="page-link"
            href="?type={{type}}&q={{q}}&page={{ page_obj.next_page_number }}">다음</a>
        </li>
        {% else %}
        <li class="page-item disabled">
            <a class="page-link" href="#">다음</a>
        </li>
        {% endif %}
    </ul>
    {% endif %}
</body>
{% endblock %}